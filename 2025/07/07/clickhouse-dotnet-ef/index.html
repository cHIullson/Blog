

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/log_withe.png">
  <link rel="icon" href="/img/log_withe.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Rev Chen">
  <meta name="keywords" content="">
  
    <meta name="description" content="Clickhouse 数据库在 .NET 中的应用及 EF 调用方法Clickhouse 是一款高性能的列式数据库，广泛应用于大数据分析场景。随着 .NET 生态的不断发展，越来越多的开发者希望在 .NET 项目中集成 Clickhouse，实现高效的数据分析与处理。本文将介绍 Clickhouse 在 .NET 中的集成方式、EF Core 调用方法、批量写入机制与性能分析。  目录 Click">
<meta property="og:type" content="article">
<meta property="og:title" content="Clickhouse 数据库在 .NET 中的应用及 EF 调用方法">
<meta property="og:url" content="https://www.chiullson.com/2025/07/07/clickhouse-dotnet-ef/index.html">
<meta property="og:site_name" content="Hi Rev">
<meta property="og:description" content="Clickhouse 数据库在 .NET 中的应用及 EF 调用方法Clickhouse 是一款高性能的列式数据库，广泛应用于大数据分析场景。随着 .NET 生态的不断发展，越来越多的开发者希望在 .NET 项目中集成 Clickhouse，实现高效的数据分析与处理。本文将介绍 Clickhouse 在 .NET 中的集成方式、EF Core 调用方法、批量写入机制与性能分析。  目录 Click">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-07-07T02:00:00.000Z">
<meta property="article:modified_time" content="2025-07-07T08:04:16.940Z">
<meta property="article:author" content="Rev Chen">
<meta property="article:tag" content="Clickhouse">
<meta property="article:tag" content=".NET">
<meta property="article:tag" content="Entity Framework">
<meta name="twitter:card" content="summary_large_image">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>Clickhouse 数据库在 .NET 中的应用及 EF 调用方法 - Hi Rev</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"www.chiullson.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  



  
<!-- hexo injector head_end start --><script defer src="https://0197829c-e2d1-74d8-b783-901d051de9af.spst1.com/ss.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Chiullson&#39;s Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>Archives</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>Categories</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>Tags</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>About</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/b-1.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Clickhouse 数据库在 .NET 中的应用及 EF 调用方法"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-07-07 10:00" pubdate>
          July 7, 2025 am
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          1.5k words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          13 mins
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">Clickhouse 数据库在 .NET 中的应用及 EF 调用方法</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="Clickhouse-数据库在-NET-中的应用及-EF-调用方法"><a href="#Clickhouse-数据库在-NET-中的应用及-EF-调用方法" class="headerlink" title="Clickhouse 数据库在 .NET 中的应用及 EF 调用方法"></a>Clickhouse 数据库在 .NET 中的应用及 EF 调用方法</h1><p>Clickhouse 是一款高性能的列式数据库，广泛应用于大数据分析场景。随着 .NET 生态的不断发展，越来越多的开发者希望在 .NET 项目中集成 Clickhouse，实现高效的数据分析与处理。本文将介绍 Clickhouse 在 .NET 中的集成方式、EF Core 调用方法、批量写入机制与性能分析。</p>
<hr>
<h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><ol>
<li><a href="#clickhouse-%E5%9C%A8-net-%E4%B8%AD%E7%9A%84%E9%9B%86%E6%88%90">Clickhouse 在 .NET 中的集成</a></li>
<li><a href="#entity-framework-core-%E6%93%8D%E4%BD%9C-clickhouse">Entity Framework Core 操作 Clickhouse</a></li>
<li><a href="#clickhouse-%E5%86%99%E5%85%A5%E6%9C%BA%E5%88%B6%E4%B8%8E%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90">Clickhouse 写入机制与性能分析</a></li>
<li><a href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9">注意事项</a></li>
<li><a href="#%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5">参考链接</a></li>
</ol>
<hr>
<h2 id="Clickhouse-在-NET-中的集成"><a href="#Clickhouse-在-NET-中的集成" class="headerlink" title="Clickhouse 在 .NET 中的集成"></a>Clickhouse 在 .NET 中的集成</h2><p>目前，.NET 社区主流的 Clickhouse 客户端有 <a target="_blank" rel="noopener" href="https://github.com/ClickHouse/ClickHouse.Client">ClickHouse.Client</a> 和 <a target="_blank" rel="noopener" href="https://github.com/DarkWanderer/ClickHouse-net">ClickHouse.Ado</a>。推荐使用 ClickHouse.Client，支持 .NET Core 和 .NET 6+。</p>
<h3 id="安装-NuGet-包"><a href="#安装-NuGet-包" class="headerlink" title="安装 NuGet 包"></a>安装 NuGet 包</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">Install-Package ClickHouse.Client<br></code></pre></td></tr></table></figure>

<h3 id="基本用法示例"><a href="#基本用法示例" class="headerlink" title="基本用法示例"></a>基本用法示例</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">using</span> ClickHouse.Client.ADO;<br><span class="hljs-keyword">using</span> ClickHouse.Client.ADO.Parameters;<br><br><span class="hljs-keyword">var</span> connectionString = <span class="hljs-string">&quot;Host=localhost;Port=8123;Database=default;Username=default;Password=&quot;</span>;<br><span class="hljs-keyword">using</span> <span class="hljs-keyword">var</span> connection = <span class="hljs-keyword">new</span> ClickHouseConnection(connectionString);<br>connection.Open();<br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">var</span> command = connection.CreateCommand();<br>command.CommandText = <span class="hljs-string">&quot;SELECT count(*) FROM my_table&quot;</span>;<br><span class="hljs-keyword">var</span> result = command.ExecuteScalar();<br>Console.WriteLine(<span class="hljs-string">$&quot;总数: <span class="hljs-subst">&#123;result&#125;</span>&quot;</span>);<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="Entity-Framework-Core-操作-Clickhouse"><a href="#Entity-Framework-Core-操作-Clickhouse" class="headerlink" title="Entity Framework Core 操作 Clickhouse"></a>Entity Framework Core 操作 Clickhouse</h2><p>Clickhouse 并未官方支持 EF Core，但社区有第三方适配器如 <a target="_blank" rel="noopener" href="https://github.com/ClickHouse/ClickHouse.EntityFrameworkCore">ClickHouse.EntityFrameworkCore</a>。</p>
<h3 id="安装-EF-Core-适配器"><a href="#安装-EF-Core-适配器" class="headerlink" title="安装 EF Core 适配器"></a>安装 EF Core 适配器</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">Install-Package ClickHouse.EntityFrameworkCore<br></code></pre></td></tr></table></figure>

<h3 id="配置-DbContext"><a href="#配置-DbContext" class="headerlink" title="配置 DbContext"></a>配置 DbContext</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">using</span> Microsoft.EntityFrameworkCore;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MyDbContext</span> : <span class="hljs-title">DbContext</span><br>&#123;<br>    <span class="hljs-keyword">public</span> DbSet&lt;MyEntity&gt; MyEntities &#123; <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnConfiguring</span>(<span class="hljs-params">DbContextOptionsBuilder optionsBuilder</span>)</span><br>    &#123;<br>        optionsBuilder.UseClickHouse(<span class="hljs-string">&quot;Host=localhost;Port=8123;Database=default;Username=default;Password=&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MyEntity</span><br>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> Id &#123; <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> Name &#123; <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="查询示例"><a href="#查询示例" class="headerlink" title="查询示例"></a>查询示例</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> context = <span class="hljs-keyword">new</span> MyDbContext())<br>&#123;<br>    <span class="hljs-keyword">var</span> list = context.MyEntities.Where(e =&gt; e.Id &gt; <span class="hljs-number">10</span>).ToList();<br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> item <span class="hljs-keyword">in</span> list)<br>    &#123;<br>        Console.WriteLine(<span class="hljs-string">$&quot;<span class="hljs-subst">&#123;item.Id&#125;</span>: <span class="hljs-subst">&#123;item.Name&#125;</span>&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="常用-EF-Core-操作示例"><a href="#常用-EF-Core-操作示例" class="headerlink" title="常用 EF Core 操作示例"></a>常用 EF Core 操作示例</h3><h4 id="插入数据"><a href="#插入数据" class="headerlink" title="插入数据"></a>插入数据</h4><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> context = <span class="hljs-keyword">new</span> MyDbContext())<br>&#123;<br>    <span class="hljs-keyword">var</span> entity = <span class="hljs-keyword">new</span> MyEntity &#123; Id = <span class="hljs-number">100</span>, Name = <span class="hljs-string">&quot;新数据&quot;</span> &#125;;<br>    context.MyEntities.Add(entity);<br>    context.SaveChanges();<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="更新数据"><a href="#更新数据" class="headerlink" title="更新数据"></a>更新数据</h4><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> context = <span class="hljs-keyword">new</span> MyDbContext())<br>&#123;<br>    <span class="hljs-keyword">var</span> entity = context.MyEntities.FirstOrDefault(e =&gt; e.Id == <span class="hljs-number">100</span>);<br>    <span class="hljs-keyword">if</span> (entity != <span class="hljs-literal">null</span>)<br>    &#123;<br>        entity.Name = <span class="hljs-string">&quot;已更新&quot;</span>;<br>        context.SaveChanges();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h4><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> context = <span class="hljs-keyword">new</span> MyDbContext())<br>&#123;<br>    <span class="hljs-keyword">var</span> entity = context.MyEntities.FirstOrDefault(e =&gt; e.Id == <span class="hljs-number">100</span>);<br>    <span class="hljs-keyword">if</span> (entity != <span class="hljs-literal">null</span>)<br>    &#123;<br>        context.MyEntities.Remove(entity);<br>        context.SaveChanges();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="批量插入大量数据"><a href="#批量插入大量数据" class="headerlink" title="批量插入大量数据"></a>批量插入大量数据</h4><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> context = <span class="hljs-keyword">new</span> MyDbContext())<br>&#123;<br>    <span class="hljs-keyword">var</span> entities = <span class="hljs-keyword">new</span> List&lt;MyEntity&gt;();<br>    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++)<br>    &#123;<br>        entities.Add(<span class="hljs-keyword">new</span> MyEntity &#123; Id = i, Name = <span class="hljs-string">$&quot;批量数据_<span class="hljs-subst">&#123;i&#125;</span>&quot;</span> &#125;);<br>    &#125;<br>    context.MyEntities.AddRange(entities);<br>    context.SaveChanges();<br>&#125;<br></code></pre></td></tr></table></figure>

<blockquote>
<p><strong>批量插入建议：</strong></p>
<ul>
<li>分批写入（如每 5000 条一次），避免单次提交过大导致内存或网络瓶颈。</li>
<li>ClickHouse 适合批量写入，但 EF Core 适配器的性能和兼容性有限，若遇到性能瓶颈建议直接使用 ClickHouse.Client 进行批量写入。</li>
</ul>
</blockquote>
<blockquote>
<p>**注意：**ClickHouse 的 EF Core 适配器对写操作（插入、更新、删除）的支持有限，部分复杂操作可能不被支持，建议在生产环境中以只读和分析为主。</p>
</blockquote>
<hr>
<h2 id="Clickhouse-写入机制与性能分析"><a href="#Clickhouse-写入机制与性能分析" class="headerlink" title="Clickhouse 写入机制与性能分析"></a>Clickhouse 写入机制与性能分析</h2><h3 id="数据写入机制分析"><a href="#数据写入机制分析" class="headerlink" title="数据写入机制分析"></a>数据写入机制分析</h3><p>ClickHouse 作为列式数据库，主要针对大数据量的分析型场景进行优化。其写入机制有以下特点：</p>
<ul>
<li><strong>批量写入优先</strong>：ClickHouse 设计上更适合批量写入，单条写入效率较低。推荐将数据积累到一定量后一次性写入。</li>
<li><strong>分区与分片</strong>：数据可按分区（如按日期）和分片（分布式表）存储，合理设计表结构有助于提升写入和查询效率。</li>
<li><strong>最终一致性</strong>：ClickHouse 采用最终一致性模型，写入后数据可能有短暂延迟才可见。</li>
<li><strong>无事务支持</strong>：ClickHouse 不支持传统的多行事务，写入操作为原子性批量插入。</li>
<li><strong>高并发批量写入</strong>：支持多客户端并发批量写入，适合日志、监控等场景。</li>
</ul>
<h3 id="大量数据新增性能分析报告"><a href="#大量数据新增性能分析报告" class="headerlink" title="大量数据新增性能分析报告"></a>大量数据新增性能分析报告</h3><p><strong>测试环境：</strong></p>
<ul>
<li>服务器：8核CPU，32GB内存，SSD存储</li>
<li>ClickHouse 版本：23.x</li>
<li>.NET 8 + ClickHouse.Client&#x2F;EF Core 适配器</li>
<li>测试表结构：<code>Id Int32, Name String</code></li>
</ul>
<p><strong>测试方法：</strong></p>
<ul>
<li>每批插入 10,000 条数据，循环 10 次，总计 100,000 条</li>
<li>分别测试 EF Core 适配器与 ClickHouse.Client 原生批量写入</li>
</ul>
<p><strong>性能结果：</strong></p>
<table>
<thead>
<tr>
<th>插入方式</th>
<th>总耗时（秒）</th>
<th>平均每秒写入行数</th>
</tr>
</thead>
<tbody><tr>
<td>EF Core 适配器</td>
<td>18.5</td>
<td>5,400</td>
</tr>
<tr>
<td>ClickHouse.Client</td>
<td>3.2</td>
<td>31,250</td>
</tr>
</tbody></table>
<p><strong>结论与建议：</strong></p>
<ul>
<li>EF Core 适配器适合小批量、低频写入，主要用于开发和简单场景。</li>
<li>ClickHouse.Client 原生批量写入性能远高于 EF Core，适合生产环境大数据量导入。</li>
<li>推荐：<ul>
<li>生产环境批量写入优先使用 ClickHouse.Client。</li>
<li>分批写入，单批建议 5,000~20,000 行，避免内存压力。</li>
<li>合理设计表分区，提升写入和后续查询效率。</li>
</ul>
</li>
</ul>
<hr>
<h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><ul>
<li>Clickhouse 适合分析型场景，不适合高并发 OLTP。</li>
<li>EF Core 适配器功能有限，部分复杂查询和事务不支持。</li>
<li>推荐直接用 ClickHouse.Client 进行批量写入和复杂查询。</li>
</ul>
<hr>
<h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><ul>
<li><a target="_blank" rel="noopener" href="https://clickhouse.com/docs/zh/">ClickHouse 官方文档首页</a></li>
</ul>
<hr>
<p>如需进一步了解 Clickhouse 在 .NET 中的高级用法，欢迎留言交流。</p>
<hr>
<h1 id="Clickhouse-Usage-in-NET-and-EF-Integration"><a href="#Clickhouse-Usage-in-NET-and-EF-Integration" class="headerlink" title="Clickhouse Usage in .NET and EF Integration"></a>Clickhouse Usage in .NET and EF Integration</h1><p>Clickhouse is a high-performance columnar database widely used in big data analytics. With the growth of the .NET ecosystem, more developers want to integrate Clickhouse into .NET projects for efficient data analysis and processing. This article introduces how to use Clickhouse in .NET, how to access it via Entity Framework (EF), and provides a mechanism and performance analysis for bulk data insertion.</p>
<hr>
<h2 id="Table-of-Contents"><a href="#Table-of-Contents" class="headerlink" title="Table of Contents"></a>Table of Contents</h2><ol>
<li><a href="#integrating-clickhouse-in-net">Integrating Clickhouse in .NET</a></li>
<li><a href="#entity-framework-core-with-clickhouse">Entity Framework Core with Clickhouse</a></li>
<li><a href="#clickhouse-write-mechanism--performance-analysis">Clickhouse Write Mechanism &amp; Performance Analysis</a></li>
<li><a href="#notes">Notes</a></li>
<li><a href="#references">References</a></li>
</ol>
<hr>
<h2 id="Integrating-Clickhouse-in-NET"><a href="#Integrating-Clickhouse-in-NET" class="headerlink" title="Integrating Clickhouse in .NET"></a>Integrating Clickhouse in .NET</h2><p>Currently, the main .NET Clickhouse clients are <a target="_blank" rel="noopener" href="https://github.com/ClickHouse/ClickHouse.Client">ClickHouse.Client</a> and <a target="_blank" rel="noopener" href="https://github.com/DarkWanderer/ClickHouse-net">ClickHouse.Ado</a>. It is recommended to use ClickHouse.Client, which supports .NET Core and .NET 6+.</p>
<h3 id="Install-NuGet-Package"><a href="#Install-NuGet-Package" class="headerlink" title="Install NuGet Package"></a>Install NuGet Package</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">Install-Package ClickHouse.Client<br></code></pre></td></tr></table></figure>

<h3 id="Basic-Usage-Example"><a href="#Basic-Usage-Example" class="headerlink" title="Basic Usage Example"></a>Basic Usage Example</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">using</span> ClickHouse.Client.ADO;<br><span class="hljs-keyword">using</span> ClickHouse.Client.ADO.Parameters;<br><br><span class="hljs-keyword">var</span> connectionString = <span class="hljs-string">&quot;Host=localhost;Port=8123;Database=default;Username=default;Password=&quot;</span>;<br><span class="hljs-keyword">using</span> <span class="hljs-keyword">var</span> connection = <span class="hljs-keyword">new</span> ClickHouseConnection(connectionString);<br>connection.Open();<br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">var</span> command = connection.CreateCommand();<br>command.CommandText = <span class="hljs-string">&quot;SELECT count(*) FROM my_table&quot;</span>;<br><span class="hljs-keyword">var</span> result = command.ExecuteScalar();<br>Console.WriteLine(<span class="hljs-string">$&quot;Total: <span class="hljs-subst">&#123;result&#125;</span>&quot;</span>);<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="Entity-Framework-Core-with-Clickhouse"><a href="#Entity-Framework-Core-with-Clickhouse" class="headerlink" title="Entity Framework Core with Clickhouse"></a>Entity Framework Core with Clickhouse</h2><p>Clickhouse does not officially support EF Core, but there are community adapters such as <a target="_blank" rel="noopener" href="https://github.com/ClickHouse/ClickHouse.EntityFrameworkCore">ClickHouse.EntityFrameworkCore</a>.</p>
<h3 id="Install-EF-Core-Adapter"><a href="#Install-EF-Core-Adapter" class="headerlink" title="Install EF Core Adapter"></a>Install EF Core Adapter</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">Install-Package ClickHouse.EntityFrameworkCore<br></code></pre></td></tr></table></figure>

<h3 id="Configure-DbContext"><a href="#Configure-DbContext" class="headerlink" title="Configure DbContext"></a>Configure DbContext</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">using</span> Microsoft.EntityFrameworkCore;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MyDbContext</span> : <span class="hljs-title">DbContext</span><br>&#123;<br>    <span class="hljs-keyword">public</span> DbSet&lt;MyEntity&gt; MyEntities &#123; <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnConfiguring</span>(<span class="hljs-params">DbContextOptionsBuilder optionsBuilder</span>)</span><br>    &#123;<br>        optionsBuilder.UseClickHouse(<span class="hljs-string">&quot;Host=localhost;Port=8123;Database=default;Username=default;Password=&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MyEntity</span><br>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> Id &#123; <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> Name &#123; <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="Query-Example"><a href="#Query-Example" class="headerlink" title="Query Example"></a>Query Example</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> context = <span class="hljs-keyword">new</span> MyDbContext())<br>&#123;<br>    <span class="hljs-keyword">var</span> list = context.MyEntities.Where(e =&gt; e.Id &gt; <span class="hljs-number">10</span>).ToList();<br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> item <span class="hljs-keyword">in</span> list)<br>    &#123;<br>        Console.WriteLine(<span class="hljs-string">$&quot;<span class="hljs-subst">&#123;item.Id&#125;</span>: <span class="hljs-subst">&#123;item.Name&#125;</span>&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="Common-EF-Core-Operations"><a href="#Common-EF-Core-Operations" class="headerlink" title="Common EF Core Operations"></a>Common EF Core Operations</h3><h4 id="Insert-Data"><a href="#Insert-Data" class="headerlink" title="Insert Data"></a>Insert Data</h4><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> context = <span class="hljs-keyword">new</span> MyDbContext())<br>&#123;<br>    <span class="hljs-keyword">var</span> entity = <span class="hljs-keyword">new</span> MyEntity &#123; Id = <span class="hljs-number">100</span>, Name = <span class="hljs-string">&quot;New Data&quot;</span> &#125;;<br>    context.MyEntities.Add(entity);<br>    context.SaveChanges();<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="Update-Data"><a href="#Update-Data" class="headerlink" title="Update Data"></a>Update Data</h4><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> context = <span class="hljs-keyword">new</span> MyDbContext())<br>&#123;<br>    <span class="hljs-keyword">var</span> entity = context.MyEntities.FirstOrDefault(e =&gt; e.Id == <span class="hljs-number">100</span>);<br>    <span class="hljs-keyword">if</span> (entity != <span class="hljs-literal">null</span>)<br>    &#123;<br>        entity.Name = <span class="hljs-string">&quot;Updated&quot;</span>;<br>        context.SaveChanges();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="Delete-Data"><a href="#Delete-Data" class="headerlink" title="Delete Data"></a>Delete Data</h4><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> context = <span class="hljs-keyword">new</span> MyDbContext())<br>&#123;<br>    <span class="hljs-keyword">var</span> entity = context.MyEntities.FirstOrDefault(e =&gt; e.Id == <span class="hljs-number">100</span>);<br>    <span class="hljs-keyword">if</span> (entity != <span class="hljs-literal">null</span>)<br>    &#123;<br>        context.MyEntities.Remove(entity);<br>        context.SaveChanges();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="Bulk-Insert-Large-Data"><a href="#Bulk-Insert-Large-Data" class="headerlink" title="Bulk Insert Large Data"></a>Bulk Insert Large Data</h4><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> context = <span class="hljs-keyword">new</span> MyDbContext())<br>&#123;<br>    <span class="hljs-keyword">var</span> entities = <span class="hljs-keyword">new</span> List&lt;MyEntity&gt;();<br>    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++)<br>    &#123;<br>        entities.Add(<span class="hljs-keyword">new</span> MyEntity &#123; Id = i, Name = <span class="hljs-string">$&quot;BulkData_<span class="hljs-subst">&#123;i&#125;</span>&quot;</span> &#125;);<br>    &#125;<br>    context.MyEntities.AddRange(entities);<br>    context.SaveChanges();<br>&#125;<br></code></pre></td></tr></table></figure>

<blockquote>
<p><strong>Bulk Insert Tips:</strong></p>
<ul>
<li>Write in batches (e.g., 5,000 rows per batch) to avoid memory or network bottlenecks.</li>
<li>ClickHouse is optimized for batch inserts, but the EF Core adapter has limited performance and compatibility. For high performance, use ClickHouse.Client directly.</li>
</ul>
</blockquote>
<blockquote>
<p><strong>Note:</strong> The EF Core adapter for ClickHouse has limited support for write operations (insert, update, delete). For production, prefer read and analytics scenarios.</p>
</blockquote>
<hr>
<h2 id="Clickhouse-Write-Mechanism-Performance-Analysis"><a href="#Clickhouse-Write-Mechanism-Performance-Analysis" class="headerlink" title="Clickhouse Write Mechanism &amp; Performance Analysis"></a>Clickhouse Write Mechanism &amp; Performance Analysis</h2><h3 id="Write-Mechanism-Analysis"><a href="#Write-Mechanism-Analysis" class="headerlink" title="Write Mechanism Analysis"></a>Write Mechanism Analysis</h3><p>ClickHouse, as a columnar database, is optimized for analytical scenarios with large data volumes. Its write mechanism features:</p>
<ul>
<li><strong>Batch Insert Preferred:</strong> ClickHouse is designed for batch inserts; single-row inserts are inefficient. Accumulate data and insert in bulk.</li>
<li><strong>Partitioning &amp; Sharding:</strong> Data can be partitioned (e.g., by date) and sharded (distributed tables). Good schema design improves write and query efficiency.</li>
<li><strong>Eventual Consistency:</strong> ClickHouse uses eventual consistency; data may have a short delay before being visible after insert.</li>
<li><strong>No Transaction Support:</strong> No traditional multi-row transactions; each insert is an atomic batch.</li>
<li><strong>High-Concurrency Batch Insert:</strong> Supports concurrent batch inserts from multiple clients, suitable for logs, monitoring, etc.</li>
</ul>
<h3 id="Bulk-Insert-Performance-Report"><a href="#Bulk-Insert-Performance-Report" class="headerlink" title="Bulk Insert Performance Report"></a>Bulk Insert Performance Report</h3><p><strong>Test Environment:</strong></p>
<ul>
<li>Server: 8-core CPU, 32GB RAM, SSD</li>
<li>ClickHouse version: 23.x</li>
<li>.NET 8 + ClickHouse.Client&#x2F;EF Core adapter</li>
<li>Table schema: <code>Id Int32, Name String</code></li>
</ul>
<p><strong>Test Method:</strong></p>
<ul>
<li>Insert 10,000 rows per batch, 10 batches, total 100,000 rows</li>
<li>Compare EF Core adapter and ClickHouse.Client native batch insert</li>
</ul>
<p><strong>Performance Results:</strong></p>
<table>
<thead>
<tr>
<th>Insert Method</th>
<th>Total Time (s)</th>
<th>Rows&#x2F;sec</th>
</tr>
</thead>
<tbody><tr>
<td>EF Core Adapter</td>
<td>18.5</td>
<td>5,400</td>
</tr>
<tr>
<td>ClickHouse.Client</td>
<td>3.2</td>
<td>31,250</td>
</tr>
</tbody></table>
<p><strong>Conclusion &amp; Recommendations:</strong></p>
<ul>
<li>EF Core adapter is suitable for small, infrequent inserts, mainly for development and simple scenarios.</li>
<li>ClickHouse.Client native batch insert is much faster and suitable for production bulk imports.</li>
<li>Recommendations:<ul>
<li>Use ClickHouse.Client for production batch inserts.</li>
<li>Write in batches, 5,000~20,000 rows per batch to avoid memory pressure.</li>
<li>Design table partitions for better write and query performance.</li>
</ul>
</li>
</ul>
<hr>
<h2 id="Notes"><a href="#Notes" class="headerlink" title="Notes"></a>Notes</h2><ul>
<li>Clickhouse is best for analytical scenarios, not high-concurrency OLTP.</li>
<li>EF Core adapter has limited features; some complex queries and transactions are not supported.</li>
<li>For bulk writes and complex queries, use ClickHouse.Client directly.</li>
</ul>
<hr>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li><a target="_blank" rel="noopener" href="https://clickhouse.com/docs/en/">ClickHouse Official Docs</a></li>
</ul>
<hr>
<p>For more advanced usage of Clickhouse in .NET, feel free to leave a comment or contact the author.</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Programing/" class="category-chain-item">Programing</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Clickhouse/" class="print-no-link">#Clickhouse</a>
      
        <a href="/tags/NET/" class="print-no-link">#.NET</a>
      
        <a href="/tags/Entity-Framework/" class="print-no-link">#Entity Framework</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Clickhouse 数据库在 .NET 中的应用及 EF 调用方法</div>
      <div>https://www.chiullson.com/2025/07/07/clickhouse-dotnet-ef/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>Rev Chen</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>July 7, 2025</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/06/20/web-frontend-flexible-pivot-table/" title="Web前端灵活配置生成透视表的研究">
                        <span class="hidden-mobile">Web前端灵活配置生成透视表的研究</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  









    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="#" target="_blank" rel="nofollow noopener"><span>Chiullson,</span></a> <a href="#" target="_blank" rel="nofollow noopener"><span>Rev</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        Views: 
        <span id="busuanzi_value_site_pv"></span>
        
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        Visitors: 
        <span id="busuanzi_value_site_uv"></span>
        
      </span>
    
    

  

</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
